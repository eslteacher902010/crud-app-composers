<div class="container py-5">
  <div class="card shadow mx-auto" style="max-width: 850px;">
    <div class="card-body p-5">
      <!-- Work Title -->
      <h1 class="text-center mb-4"><%= work.title %></h1>

      <!-- Work Details -->
      <div class="mb-4">
        <p><strong>Genre:</strong> <%= work.genre || "â€”" %></p>

        <% if (work.composer) { %>
          <p><strong>Composer:</strong> 
            <a href="/composers/<%= work.composer.apiId || work.composer._id %>" class="text-decoration-none">
              <%= work.composer.completeName %>
            </a>
          </p>
        <% } %>

        <% if (work.yearComposed) { %>
          <p><strong>Year Composed:</strong> <%= work.yearComposed %></p>
        <% } %>

        <% if (work.catalogueSystem) { %>
          <p><strong>Catalogue System:</strong> <%= work.catalogueSystem %></p>
        <% } %>

        <% if (work.catalogueNumber) { %>
          <p><strong>Catalogue Number:</strong> <%= work.catalogueNumber %></p>
        <% } %>
      </div>

      <!-- YouTube Preview -->
      <% if (work.youTube) { 
        const embedUrl = work.youTube.replace("watch?v=", "embed/");
      %>
        <div class="mb-5">
          <a href="<%= work.youTube %>" target="_blank" class="btn btn-outline-secondary mb-3">
            Watch on YouTube
          </a>
          <div class="ratio ratio-16x9 rounded shadow-sm">
            <iframe 
              src="<%= embedUrl %>"
              title="YouTube video player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen>
            </iframe>
          </div>
        </div>
      <% } %>

      <!-- Favorites Button -->
      <div class="mb-4">
        <form method="POST" action="/works/<%= work.apiId || work._id %>/favorites">
          <% if (user && work.favoritedBy.includes(user._id)) { %>
            <button class="btn btn-danger w-100" type="submit">Remove Work from Favorites</button>
          <% } else { %>
            <button class="btn btn-success w-100" type="submit">Add Work to Favorites</button>
          <% } %>
        </form>
      </div>

      <!-- Edit + Back -->
      <div class="d-flex justify-content-between">
        <% if (user) { %>
          <a href="/works/<%= work.apiId || work._id %>/edit" class="btn btn-outline-primary">Edit Work</a>
        <% } %>
        <a href="/works" class="btn btn-outline-secondary">Back to Works</a>
      </div>
    </div>
  </div>
</div>
