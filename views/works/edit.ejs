<div class="container py-5">
  <div class="card shadow-lg mx-auto" style="max-width: 700px;">
    <div class="card-body p-4">
      <h1 class="text-center mb-3">Edit Work</h1>
      <p class="text-muted text-center mb-4">
        <strong>Note:</strong> Use this form to update or add information about the work.
        Database information from OpenOpus will not be changed (except for local works).
      </p>

      <!-- âœ… Update form -->
      <form action="/works/<%= work.apiId || work._id %>?_method=PUT" method="POST">
        <input type="hidden" name="_method" value="PUT" />

        <!-- Editable Title (local only) -->
        <% if (work.source && work.source.toLowerCase().trim() === "local") { %>
          <div class="form-floating mb-3">
            <input type="text" class="form-control" id="title" name="title" 
                   value="<%= work.title %>" placeholder="Title" required>
            <label for="title">Title</label>
          </div>
        <% } else { %>
          <h3 class="text-center mb-3"><%= work.title || work.subtitle %></h3>
        <% } %>

        <!-- Composer Info -->
        <% if (work.composer) { %>
          <div class="mb-3">
            <label class="form-label">Composer</label>
            <p>
              <a href="/composers/<%= work.composer.apiId %>">
                <%= work.composer.completeName %>
              </a>
              |
              <a href="https://openopus.org/composer/detail/<%= work.composer.apiId %>" target="_blank">
                OpenOpus Profile
              </a>
            </p>
            <input type="hidden" name="composerInput" value="<%= work.composer._id %>" />
          </div>
        <% } else { %>
          <div class="form-floating mb-3">
            <input type="text" class="form-control" id="composer" name="composerInput"
                   placeholder="Enter OpenOpus composer ID or name">
            <label for="composer">Composer (apiId or name)</label>
            <small class="text-muted">
              Tip: Look up a composer on 
              <a href="https://openopus.org/composer/list/popular" target="_blank">OpenOpus</a>
            </small>
          </div>
        <% } %>

        <!-- Genre -->
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="genre" name="genreInput" 
                 value="<%= work.genre || '' %>" placeholder="Genre">
          <label for="genre">Genre</label>
        </div>

        <!-- Year Composed -->
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="yearComposed" name="yearComposed"
                 value="<%= work.yearComposed || '' %>" placeholder="Year Composed">
          <label for="yearComposed">Year Composed</label>
        </div>

        <!-- Catalogue -->
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="catalogueSystem" name="catalogueSystem"
                 value="<%= work.catalogueSystem || '' %>" placeholder="Catalogue System">
          <label for="catalogueSystem">Catalogue System</label>
        </div>

        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="catalogueNumber" name="catalogueNumber"
                 value="<%= work.catalogueNumber || '' %>" placeholder="Catalogue Number">
          <label for="catalogueNumber">Catalogue Number</label>
        </div>

        <!-- YouTube -->
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="youTube" name="youTube"
                 value="<%= work.youTube || '' %>" placeholder="YouTube link">
          <label for="youTube">YouTube</label>
        </div>

        <!-- Submit -->
        <div class="d-grid">
          <button type="submit" class="btn btn-success btn-lg">Save Changes</button>
        </div>
      </form>

      <!-- Back Button -->
      <div class="text-center mt-4">
        <a class="btn btn-outline-secondary" href="/">Back to Home</a>
      </div>
    </div>
  </div>
</div>
